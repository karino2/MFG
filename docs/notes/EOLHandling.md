# 改行の扱いについて

- Created: 2024-12-21

改行はスペースとして動いて欲しい事が多い。
例えば

```
def ts |x,
        y|
{
  x+y
}
```

のように、引数のところなどに自由に改行を挟んでも構わない方が嬉しい。

だがMFGには行末にセミコロンが無い。
しかもreturnも無く、最後の式がreturnの値となる。

だから以下のようなコードがあった時に

```
let a = 5
-3
```

これが `let a = 5 - 3`　と解釈されるのは嬉しくない。

一般に、関数呼び出し等のかっこや`|x, y|`の縦棒などのように、始まりと終わりが明示されるものなら、
この間は改行があっても構わない。
この辺はだいたい許している。

でも中括弧はreduceなどで値を返すケースでは最後の式は改行で区切りたいので、中括弧はそういう処理は無い。

また、def系列で並びが決まっているもの、
例えば

```
def ts2 by reduce<hist>.accumulate(init=1, dim=0) |i, col, val, accm | { accm + val }
```

みたいなケースでは、中括弧の始まりまではだいたい改行は許している。

この手の改行を空白とみなすかどうかは言語ごとに特徴が出るところだ。
式の途中なら改行を許す、という言語もある。例えば以下のようなもの。

```
let a = 5 -
3
```

この場合は `let a = 5-3` と解釈される、というもの。

MFGではこの辺の結論はまだ出ていないが、素直にバックスラッシュでエスケープするのを推奨したい（ただ改行のエスケープはまだ実装してない気がする、そのうちします）。

```
let a = 5 \
- 3
```

実用上は関数呼び出しだとかテンソル定義の仮引数などで改行が許されていれば、
あまり困る事は無いので、改行のエスケープが必要になった事は今のところ無い。